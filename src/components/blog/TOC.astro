---
import { generateToc } from "@/utils/generateToc";
import type { MarkdownHeading } from "astro";
import { Icon } from "astro-icon/components";
import TOCHeading from "./TOCHeading.astro";

interface Props {
	headings: MarkdownHeading[];
}

const { headings } = Astro.props;

const toc = generateToc(headings);
---

<div class="sticky top-20 rounded-t-lg">
	<div class="sticky top-20 rounded-t-lg bg-bgColor">
		<div
			class="title sticky top-20 flex items-end gap-x-1 rounded-t-lg border-l border-r border-t border-special-light bg-color-75 pb-2 pe-4 ps-8 pt-4"
		>
			<!--
			<Icon aria-hidden="true" class="flex-shrink-0 h-8 w-6 py-1" focusable="false" name="solar:clipboard-list-line-duotone" />
			-->
			<h4 class="title">Table of Contents</h4>
			<button
				id="close-toc"
				class="absolute right-4 top-4 flex h-8 w-8 items-center justify-center rounded-lg bg-accent-base/5 text-accent-base hover:bg-accent-base/10"
				aria-label="Close TOC"
			>
				<Icon aria-hidden="true" class="h-6 w-6" focusable="false" name="hugeicons:cancel-01" />
			</button>
		</div>
	</div>
	<div class="rounded-b-lg bg-bgColor">
		<div class="rounded-b-lg border-b border-l border-r border-special-light bg-color-75 pb-6">
			<div class="h-auto max-h-[calc(100vh-11rem)] overflow-hidden overflow-y-auto px-8">
				<ul class="text-sm font-medium text-textColor">
					{toc.map((heading) => <TOCHeading heading={heading} />)}
				</ul>
			</div>
		</div>
	</div>
</div>
